<div class="mb-2">
    <button class="mr-1" type="button" mat-raised-button color="accent"
        (click)="addTempNode(folderNodeTypes.TEMP_FOLDER)" matTooltip="Add new folder" matTooltipPosition="above">
        <mat-icon>create_new_folder</mat-icon>
    </button>
    <button class="mr-1" type="button" mat-raised-button color="accent"
        (click)="addTempNode(folderNodeTypes.TEMP_RECORDING)" matTooltip="Add new recording" matTooltipPosition="above">
        <mat-icon>note_add</mat-icon>
    </button>
    <!-- <button type="button" mat-raised-button color="accent" (click)="deleteNode()" matTooltip="Delete selected"
        matTooltipPosition="above">
        <mat-icon>delete</mat-icon>
    </button> -->
</div>

<cdk-tree #cdkTree [dataSource]="dataSource" [treeControl]="treeControl">
    <!-- This is the tree node template for leaf nodes -->
    <cdk-nested-tree-node *cdkTreeNodeDef="let node" class="example-tree-node m-1 p-2">
        <!-- use a disabled button to provide padding for tree leaf -->
        <!-- <button mat-icon-button disabled></button> -->
        <div class="leaf-node" *ngIf="node.nodeType !== folderNodeTypes.TEMP_RECORDING; else tempRecordingNodeBlock">
            <mat-checkbox class="pl-5" [checked]="node.isChecked" (change)="onNodeCheck(node)">
                <button mat-stroked-button color="primary" (click)="onRecordingClick(node)">
                    <mat-icon class="folder-icon">text_snippet</mat-icon>{{node.name}}
                </button>
            </mat-checkbox>
            <div class="pl-2 pb-2 node-actions">
                <button type="button" mat-icon-button color="accent" (click)="deleteNode(node)"
                    matTooltip="Delete Recording" matTooltipPosition="above">
                    <mat-icon>delete</mat-icon>
                </button>
            </div>
        </div>
        <ng-template #tempRecordingNodeBlock>
            <span class="temp-node-span temp-leaf-node-span">
                <input matInput [(ngModel)]="node.name" placeholder="recording name" />
                <a mat-button class="d-inline-block" (click)="saveTempNode(node, folderNodeTypes.RECORDING)">Save</a>
            </span>
        </ng-template>
    </cdk-nested-tree-node>
    <!-- This is the tree node template for expandable nodes -->
    <cdk-nested-tree-node *cdkTreeNodeDef="let node; when: hasChild"
        class="example-tree-node border-left border-bottom">
        <button mat-icon-button [attr.aria-label]="'Toggle ' + node.name" cdkTreeNodeToggle>
            <mat-icon class="mat-icon-rtl-mirror">
                {{treeControl.isExpanded(node) ? 'expand_more' : 'chevron_right'}}
            </mat-icon>
        </button>
        <span *ngIf="node.nodeType !== folderNodeTypes.TEMP_FOLDER; else tempFolderNodeBlock">
            <mat-checkbox class="checklist-leaf-node" [checked]="node.isChecked" (change)="onNodeCheck(node)">
                <mat-icon class="folder-icon">folder</mat-icon>
                {{node.name}}
            </mat-checkbox>
        </span>
        <ng-template #tempFolderNodeBlock>
            <span class="temp-node-span">
                <input matInput [(ngModel)]="node.name" placeholder="folder name" />
                <a mat-button class="d-inline-block" (click)="saveTempNode(node, folderNodeTypes.FOLDER)">Save</a>
            </span>
        </ng-template>
        <!-- <div [class.example-tree-invisible]="!treeControl.isExpanded(node)">
            <ng-container cdkTreeNodeOutlet></ng-container>
        </div> -->
        <div *ngIf="treeControl.isExpanded(node)">
            <ng-container cdkTreeNodeOutlet></ng-container>
        </div>
    </cdk-nested-tree-node>
</cdk-tree>